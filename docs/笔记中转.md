### 3.6 ç”¨ä¸¤ä¸ªé˜Ÿåˆ—å®ç°æ ˆ

- é—®é¢˜æè¿°

  è¯·ä½ ä»…ä½¿ç”¨ä¸¤ä¸ªé˜Ÿåˆ—å®ç°ä¸€ä¸ªåå…¥å…ˆå‡ºçš„æ ˆï¼Œå¹¶æ”¯æŒæ™®é€šæ ˆçš„å…¨éƒ¨å››ç§æ“ä½œï¼ˆpushã€topã€pop å’Œ emptyï¼‰ï¼Œè¾“å…¥æ•°æ®ä¿è¯ popã€topå‡½æ•°æ“ä½œæ—¶ï¼Œæ ˆä¸­ä¸€å®šæœ‰å…ƒç´ ã€‚ 

```java
void push(int element) å°†å…ƒç´  element å‹å…¥æ ˆé¡¶ã€‚ 
int pop() ç§»é™¤å¹¶è¿”å›æ ˆé¡¶å…ƒç´ ã€‚ 
int top() è¿”å›æ ˆé¡¶å…ƒç´ ã€‚ 
bool empty() å¦‚æœæ ˆæ˜¯ç©ºçš„ï¼Œè¿”å› true ï¼›å¦åˆ™ï¼Œè¿”å› false 
è¾“å…¥:    ["MTY","PSH1","TOP","MTY"]
è¾“å‡º:    ["true","1","false"]
è§£æ:
"MTY"è¡¨ç¤ºå½“å‰æ ˆæ˜¯ä¸æ˜¯ä¸ºç©º=>å½“å‰ä¸ºç©ºï¼Œè¿”å›"true"
"PSH1"è¡¨ç¤ºå°†1å‹å…¥æ ˆä¸­ï¼Œæ ˆä¸­å…ƒç´ ä¸º1
"TOP"è¡¨ç¤ºè·å–æ ˆé¡¶å…ƒç´ ==>è¿”å›"1"
"MTY"è¡¨ç¤ºå½“å‰æ ˆæ˜¯ä¸æ˜¯ä¸ºç©º=>å½“å‰ä¸ä¸ºç©ºï¼Œè¿”å›"false"
```

- æ€è·¯ï¼š
  ä¸ºäº†æ»¡è¶³æ ˆçš„ç‰¹æ€§ï¼Œå³æœ€åå…¥æ ˆçš„å…ƒç´ æœ€å…ˆå‡ºæ ˆï¼Œåœ¨ä½¿ç”¨é˜Ÿåˆ—å®ç°æ ˆæ—¶ï¼Œåº”æ»¡è¶³é˜Ÿåˆ—å‰ç«¯çš„å…ƒç´ æ˜¯æœ€åå…¥æ ˆçš„å…ƒç´ ã€‚å¯ä»¥ä½¿ç”¨ä¸¤ä¸ªé˜Ÿåˆ—å®ç°æ ˆçš„æ“ä½œï¼Œå…¶ä¸­ queue1ç”¨äºå­˜å‚¨æ ˆå†…çš„å…ƒç´ ï¼Œqueue2 ä½œä¸ºå…¥æ ˆæ“ä½œçš„è¾…åŠ©é˜Ÿåˆ—ã€‚å…¥æ ˆæ“ä½œæ—¶ï¼Œé¦–å…ˆå°†å…ƒç´ å…¥é˜Ÿåˆ° queue2ï¼Œç„¶åå°†queue1 çš„å…¨éƒ¨å…ƒç´ ä¾æ¬¡å‡ºé˜Ÿå¹¶å…¥é˜Ÿåˆ° queue2 ï¼Œæ­¤æ—¶ queue2 çš„å‰ç«¯çš„å…ƒç´ å³ä¸ºæ–°å…¥æ ˆçš„å…ƒç´ ï¼Œå†å°† queue1 å’Œ queue2äº’æ¢ï¼Œåˆ™queue1çš„å…ƒç´ å³ä¸ºæ ˆå†…çš„å…ƒç´ ï¼Œqueue1 çš„å‰ç«¯å’Œåç«¯åˆ†åˆ«å¯¹åº”æ ˆé¡¶å’Œæ ˆåº•ã€‚ç”±äºæ¯æ¬¡å…¥æ ˆæ“ä½œéƒ½ç¡®ä¿queue1  çš„å‰ç«¯å…ƒç´ ä¸ºæ ˆé¡¶å…ƒç´ ï¼Œå› æ­¤å‡ºæ ˆæ“ä½œå’Œè·å¾—æ ˆé¡¶å…ƒç´ æ“ä½œéƒ½å¯ä»¥ç®€å•å®ç°ã€‚å‡ºæ ˆæ“ä½œåªéœ€è¦ç§»é™¤queue1 çš„å‰ç«¯å…ƒç´ å¹¶è¿”å›å³å¯ï¼Œè·å¾—æ ˆé¡¶å…ƒç´ æ“ä½œåªéœ€è¦è·å¾— queue1 çš„å‰ç«¯å…ƒç´ å¹¶è¿”å›å³å¯ï¼ˆä¸ç§»é™¤å…ƒç´ ï¼‰ã€‚ç”±äº queue1 ç”¨äºå­˜å‚¨æ ˆå†…çš„å…ƒç´ ï¼Œåˆ¤æ–­æ ˆæ˜¯å¦ä¸ºç©ºæ—¶ï¼Œåªéœ€è¦åˆ¤æ–­ queue1  æ˜¯å¦ä¸ºç©ºå³å¯ã€‚

![fig1](Datastructureandalgorithm.assets/225_fig1-165478397283815.gif)

- ä»£ç 

```java
import java.util.*;
class MyStack {
    Queue<Integer> queue1;
    Queue<Integer> queue2;

    public MyStack() {
        queue1 = new LinkedList<Integer>();
        queue2 = new LinkedList<Integer>();
    }
    
    public void push(int x) {
        queue2.offer(x);
        while (!queue1.isEmpty()) {
            queue2.offer(queue1.poll());
        }
        Queue<Integer> temp = queue1;
        queue1 = queue2;
        queue2 = temp;
    }
    
    public int pop() {
        return queue1.poll();
    }
    
    public int top() {
        return queue1.peek();
    }
    
    public boolean empty() {
        return queue1.isEmpty();
    }
}
```

### 3.7 åŒ…å«minå‡½æ•°çš„æ ˆ

- é—®é¢˜æè¿°ï¼šå®šä¹‰æ ˆçš„æ•°æ®ç»“æ„ï¼Œè¯·åœ¨è¯¥ç±»å‹ä¸­å®ç°ä¸€ä¸ªèƒ½å¤Ÿå¾—åˆ°æ ˆä¸­æ‰€å«æœ€å°å…ƒç´ çš„ min å‡½æ•°ï¼Œè¾“å…¥æ“ä½œæ—¶ä¿è¯ popã€top å’Œ min å‡½æ•°æ“ä½œæ—¶ï¼Œæ ˆä¸­ä¸€å®šæœ‰å…ƒç´ ã€‚æ­¤æ ˆåŒ…å«çš„æ–¹æ³•æœ‰ï¼š

```java
push(value):å°†valueå‹å…¥æ ˆä¸­
pop():å¼¹å‡ºæ ˆé¡¶å…ƒç´ 
top():è·å–æ ˆé¡¶å…ƒç´ 
min():è·å–æ ˆä¸­æœ€å°å…ƒç´ 
```

- æ€è·¯

æˆ‘ä»¬éƒ½çŸ¥é“æ ˆç»“æ„çš„pushã€popã€topæ“ä½œéƒ½æ˜¯O(1)O(1)*O*(1)ï¼Œä½†æ˜¯`min`å‡½æ•°åšä¸åˆ°ï¼Œäºæ˜¯æƒ³åˆ°åœ¨pushçš„æ—¶å€™å°±å°†æœ€å°å€¼è®°å½•ä¸‹æ¥ï¼Œç”±äºæ ˆå…ˆè¿›åå‡ºçš„ç‰¹æ®Šæ€§ï¼Œæˆ‘ä»¬å¯ä»¥æ„é€ ä¸€ä¸ªå•è°ƒæ ˆï¼Œä¿è¯æ ˆå†…å…ƒç´ éƒ½æ˜¯é€’å¢çš„ï¼Œæ ˆé¡¶å…ƒç´ å°±æ˜¯å½“å‰æœ€å°çš„å…ƒç´ ã€‚æ­¤å¤–ä¸»æ ˆpopçš„æ—¶å€™ï¼Œè¾…åŠ©æ ˆä¹Ÿéœ€è¦ç›¸åº”çš„popã€‚

![å›¾ç‰‡è¯´æ˜](Datastructureandalgorithm.assets/BF24FE790ACB10342DE5628AEC3283ED.gif)

- ä»£ç 

```java
import java.util.Stack;
public class Solution {
    Stack<Integer> stack1 = new Stack();
    Stack<Integer> stack2 = new Stack();
    public void push(int node) {
        stack1.push(node);
        if(stack2.isEmpty() || stack2.peek() > node){
            stack2.push(node);
        }else{
            stack2.push(stack2.peek());
        }
    }
    public void pop() {
        stack1.pop();
        stack2.pop();
    }
    public int top() {
        return stack1.peek();
    }
    public int min() {
        return stack2.peek();
    }
}
```

### 3.8 æœ€å°çš„Kä¸ªæ•°

- é—®é¢˜æè¿°

  ç»™å®šä¸€ä¸ªé•¿åº¦ä¸º n çš„å¯èƒ½æœ‰é‡å¤å€¼çš„æ•°ç»„ï¼Œæ‰¾å‡ºå…¶ä¸­ä¸å»é‡çš„æœ€å°çš„ k ä¸ªæ•°ã€‚ä¾‹å¦‚æ•°ç»„å…ƒç´ æ˜¯4,5,1,6,2,7,3,8è¿™8ä¸ªæ•°å­—ï¼Œåˆ™æœ€å°çš„4ä¸ªæ•°å­—æ˜¯1,2,3,4(ä»»æ„é¡ºåºçš†å¯)ã€‚

- ç¤ºä¾‹

```java
è¾“å…¥ï¼š[4,5,1,6,2,7,3,8],4 
è¾“å‡ºï¼š[1,2,3,4]
```

- æ€è·¯

  å»ºç«‹ä¸€ä¸ªå®¹é‡ä¸ºkçš„å¤§é¡¶å †ï¼ˆå †é¡¶å­˜æ”¾å †ä¸­çš„æœ€å¤§çš„å…ƒç´ ï¼‰çš„ä¼˜å…ˆé˜Ÿåˆ—ã€‚éå†ä¸€éå…ƒç´ ï¼Œå¦‚æœå †ä¸­å…ƒç´ ä¸ªæ•°<k,å°±ç›´æ¥å…¥å †ï¼Œå¦åˆ™ï¼Œè®©å½“å‰å…ƒç´ ä¸å †é¡¶å…ƒç´ ç›¸æ¯”ï¼Œå¦‚æœå †é¡¶å…ƒç´ å¤§ï¼Œåˆ™å †é¡¶å…ƒç´ å‡ºé˜Ÿï¼Œå°†å½“å‰å…ƒç´ å…¥å †

- ä»£ç 

```java
import java.util.*;

public class Solution {
    public ArrayList<Integer> GetLeastNumbers_Solution(int [] input, int k) {
        ArrayList<Integer> res = new ArrayList();
        if(input.length < k || k == 0) return res;
        Queue<Integer> queue = new PriorityQueue<>(k ,new Comparator<Integer>(){
            public int compare(Integer o1 , Integer o2){
                return o2 -o1;
            }
        });
        for(int i = 0 ; i < input.length ; i++){
            if( queue.size() < k){
                queue.add(input[i]);
            }else{
                if(queue.peek() > input[i]){
                    queue.poll();
                    queue.add(input[i]);
                }
            }
        }
        while(!queue.isEmpty()){
            res.add(queue.poll());
        }
        return res;
    }
}
```

### 3.9 å¯»æ‰¾ç¬¬Kå¤§çš„æ•°ï¼ˆå¿«é€Ÿæ’åº\å°é¡¶å †ï¼‰

- æè¿°

  ```java
  æœ‰ä¸€ä¸ªæ•´æ•°æ•°ç»„ï¼Œè¯·ä½ æ ¹æ®å¿«é€Ÿæ’åºçš„æ€è·¯ï¼Œæ‰¾å‡ºæ•°ç»„ä¸­ç¬¬Kå¤§çš„æ•°ã€‚
  ç»™å®šä¸€ä¸ªæ•´æ•°æ•°ç»„a,åŒæ—¶ç»™å®šå®ƒçš„å¤§å°nå’Œè¦æ‰¾çš„K(Kåœ¨``1``åˆ°nä¹‹é—´)ï¼Œè¯·è¿”å›ç¬¬Kå¤§çš„æ•°ï¼Œä¿è¯ç­”æ¡ˆå­˜åœ¨ã€‚
  ```

- ä»£ç 1ï¼šå°é¡¶å †(å †å¤§å°ä¸ºKï¼Œå †é¡¶å°±æ˜¯å€’æ•°ç¬¬Kå¤§çš„å…ƒç´ )

  ```java
  import java.util.*;
  public class Solution {
     public int findKth(int[] a, int n, int K){
      // æš‚å­˜Kä¸ªè¾ƒå¤§çš„å€¼ï¼Œä¼˜å…ˆé˜Ÿåˆ—é»˜è®¤æ˜¯è‡ªç„¶æ’åºï¼ˆå‡åºï¼‰ï¼Œé˜Ÿå¤´å…ƒç´ ï¼ˆæ ¹ï¼‰æ˜¯å †å†…çš„æœ€å°å…ƒç´ ï¼Œä¹Ÿå°±æ˜¯å°æ ¹å †
      PriorityQueue<Integer> queue = new PriorityQueue<>(K);
      // éå†æ¯ä¸€ä¸ªå…ƒç´ ï¼Œè°ƒæ•´å°æ ¹å †
      for (int num : a) {
          // å¯¹äºå°æ ¹å †æ¥è¯´ï¼Œåªè¦æ²¡æ»¡å°±å¯ä»¥åŠ å…¥ï¼ˆä¸éœ€è¦æ¯”è¾ƒï¼‰ï¼›å¦‚æœæ»¡äº†ï¼Œæ‰åˆ¤æ–­æ˜¯å¦éœ€è¦æ›¿æ¢ç¬¬ä¸€ä¸ªå…ƒç´ 
          if (queue.size() < K) {
              queue.add(num);
          } else {
              // åœ¨å°æ ¹å †å†…ï¼Œå­˜å‚¨ç€Kä¸ªè¾ƒå¤§çš„å…ƒç´ ï¼Œæ ¹æ˜¯è¿™Kä¸ªä¸­æœ€å°çš„ï¼Œå¦‚æœå‡ºç°æ¯”æ ¹è¿˜è¦å¤§çš„å…ƒç´ ï¼Œè¯´æ˜å¯ä»¥æ›¿æ¢æ ¹
              if (num > queue.peek()) {
                  queue.poll(); // é«˜ä¸ªä¸­æŒ‘çŸ®ä¸ªï¼ŒçŸ®ä¸ªæ·˜æ±°
                  queue.add(num);
              }
          }
      }
      return queue.isEmpty() ? 0 : queue.peek();
  	}
  
  }
  ```

- ä»£ç 2ï¼šå¿«é€Ÿæ’åº + äºŒåˆ†æ³•

  - æ€è·¯ï¼š
  - step 1ï¼šè¿›è¡Œä¸€æ¬¡å¿«æ’ï¼Œå¤§å…ƒç´ åœ¨å·¦ï¼Œå°å…ƒç´ åœ¨å³ï¼Œå¾—åˆ°çš„ä¸­è½´pç‚¹ã€‚
  - step 2ï¼šå¦‚æœ p - low + 1 = k ï¼Œé‚£ä¹ˆpç‚¹å°±æ˜¯ç¬¬Kå¤§ã€‚
  - step 3ï¼šå¦‚æœ p - low + 1 > kï¼Œåˆ™ç¬¬kå¤§çš„å…ƒç´ åœ¨å·¦åŠæ®µï¼Œæ›´æ–°high = p - 1ï¼Œæ‰§è¡Œstep 1ã€‚
  - step 4ï¼šå¦‚æœ p - low + 1 < kï¼Œåˆ™ç¬¬kå¤§çš„å…ƒç´ åœ¨å³åŠæ®µï¼Œæ›´æ–°low = p + 1, ä¸” k = k - (p - low + 1)ï¼Œæ’é™¤æ‰å‰é¢éƒ¨åˆ†æ›´å¤§çš„å…ƒç´ ï¼Œå†æ‰§è¡Œstep 1.

  ```java
  import java.util.*;
  
  public class Solution {
      public int findKth(int[] a, int n, int K) {
          return quickSort(a, 0, a.length - 1, K);
      }
  
      private int quickSort(int[] arr, int left, int right, int k){
          int p = partition(arr, left, right);
          // æ”¹è¿›åï¼Œå¾ˆç‰¹æ®Šçš„æ˜¯ï¼Œpæ˜¯å…¨å±€ä¸‹æ ‡ï¼Œåªè¦på¯¹ä¸ŠtopKåæ ‡å°±å¯ä»¥è¿”å›
          if (p == arr.length - k) {
              return arr[p];
          }else if (p < arr.length - k) {
              // å¦‚æœåŸºå‡†åœ¨å·¦è¾¹ï¼Œè¿™åœ¨å³è¾¹æ‰¾
              return quickSort(arr, p + 1, right,k);
          }else {
              return quickSort(arr, left, p - 1,k);
          }
      }
  
      private int partition(int[] arr, int left, int right) {
          // å¯ä¼˜åŒ–æˆéšæœºï¼Œæˆ–ä¸­ä½æ•°
          int key = arr[left];
          while (left < right) {
              while (left < right && arr[right] >= key) right--;
              arr[left] = arr[right];
              while (left < right && arr[left] <= key) left++;
              arr[right] = arr[left];
          }
          arr[left] = key;
          return left;
      }
  }
  
  ```


### 3.10 æ•°æ®æµä¸­çš„ä¸­ä½æ•°

- é¢˜ç›®æè¿°

  å¦‚ä½•å¾—åˆ°ä¸€ä¸ªæ•°æ®æµä¸­çš„ä¸­ä½æ•°ï¼Ÿå¦‚æœä»æ•°æ®æµä¸­è¯»å‡ºå¥‡æ•°ä¸ªæ•°å€¼ï¼Œé‚£ä¹ˆä¸­ä½æ•°å°±æ˜¯æ‰€æœ‰æ•°å€¼æ’åºä¹‹åä½äºä¸­é—´çš„æ•°å€¼ã€‚å¦‚æœä»æ•°æ®æµä¸­è¯»å‡ºå¶æ•°ä¸ªæ•°å€¼ï¼Œé‚£ä¹ˆä¸­ä½æ•°å°±æ˜¯æ‰€æœ‰æ•°å€¼æ’åºä¹‹åä¸­é—´ä¸¤ä¸ªæ•°çš„å¹³å‡å€¼ã€‚æˆ‘ä»¬ä½¿ç”¨Insert()æ–¹æ³•è¯»å–æ•°æ®æµï¼Œä½¿ç”¨GetMedian()æ–¹æ³•è·å–å½“å‰è¯»å–æ•°æ®çš„ä¸­ä½æ•°ã€‚

-  è§£é¢˜æ€è·¯

  - å…ˆç”¨javaé›†åˆPriorityQueueæ¥è®¾ç½®ä¸€ä¸ªå°é¡¶å †å’Œå¤§é¡¶å †
  - ä¸»è¦çš„æ€æƒ³æ˜¯ï¼šå› ä¸ºè¦æ±‚çš„æ˜¯ä¸­ä½æ•°ï¼Œé‚£ä¹ˆè¿™ä¸¤ä¸ªå †ï¼Œ**å¤§é¡¶å †ç”¨æ¥å­˜è¾ƒå°çš„æ•°ï¼Œä»å¤§åˆ°å°æ’åˆ—**ï¼›
  - å°é¡¶å †å­˜è¾ƒå¤§çš„æ•°ï¼Œä»å°åˆ°å¤§çš„é¡ºåºæ’åº**ï¼Œæ˜¾ç„¶ä¸­ä½æ•°å°±æ˜¯å¤§é¡¶å †çš„æ ¹èŠ‚ç‚¹ä¸å°é¡¶å †çš„æ ¹èŠ‚ç‚¹å’Œçš„å¹³å‡æ•°ã€‚

  - â­ä¿è¯ï¼šå°é¡¶å †ä¸­çš„å…ƒç´ éƒ½å¤§äºç­‰äºå¤§é¡¶å †ä¸­çš„å…ƒç´ ï¼Œæ‰€ä»¥æ¯æ¬¡å¡å€¼ï¼Œå¹¶ä¸æ˜¯ç›´æ¥å¡è¿›å»ï¼Œè€Œæ˜¯ä»å¦ä¸€ä¸ªå †ä¸­pollå‡ºä¸€ä¸ªæœ€å¤§ï¼ˆæœ€å°ï¼‰çš„å¡å€¼

  - â­å½“æ•°ç›®ä¸ºå¶æ•°çš„æ—¶å€™ï¼Œå°†è¿™ä¸ªå€¼æ’å…¥å¤§é¡¶å †ä¸­ï¼Œå†å°†å¤§é¡¶å †ä¸­æ ¹èŠ‚ç‚¹ï¼ˆå³æœ€å¤§å€¼ï¼‰æ’å…¥åˆ°å°é¡¶å †ä¸­ï¼›

  - â­å½“æ•°ç›®ä¸ºå¥‡æ•°çš„æ—¶å€™ï¼Œå°†è¿™ä¸ªå€¼æ’å…¥å°é¡¶å †ä¸­ï¼Œå†è®²å°é¡¶å †ä¸­æ ¹èŠ‚ç‚¹ï¼ˆå³æœ€å°å€¼ï¼‰æ’å…¥åˆ°å¤§é¡¶å †ä¸­ï¼›

  - â­å–ä¸­ä½æ•°çš„æ—¶å€™ï¼Œå¦‚æœå½“å‰ä¸ªæ•°ä¸ºå¶æ•°ï¼Œæ˜¾ç„¶æ˜¯å–å°é¡¶å †å’Œå¤§é¡¶å †æ ¹ç»“ç‚¹çš„å¹³å‡å€¼ï¼›å¦‚æœå½“å‰ä¸ªæ•°ä¸ºå¥‡æ•°ï¼Œæ˜¾ç„¶æ˜¯å–å°é¡¶å †çš„æ ¹èŠ‚ç‚¹

- æ€è·¯éªŒè¯

  ä¾‹å¦‚ï¼Œä¼ å…¥çš„æ•°æ®ä¸ºï¼š[5,2,3,4,1,6,7,0,8],é‚£ä¹ˆæŒ‰ç…§è¦æ±‚ï¼Œè¾“å‡ºæ˜¯"5.00 3.50 3.00 3.50 3.00 3.50 4.00 3.50 4.00 "é‚£ä¹ˆæ•´ä¸ªç¨‹åºçš„æ‰§è¡Œæµç¨‹åº”è¯¥æ˜¯ï¼ˆç”¨minè¡¨ç¤ºå°é¡¶å †ï¼Œmaxè¡¨ç¤ºå¤§é¡¶å †ï¼‰ï¼š

  - 5å…ˆè¿›å…¥å¤§é¡¶å †ï¼Œç„¶åå°†å¤§é¡¶å †ä¸­æœ€å¤§å€¼æ”¾å…¥å°é¡¶å †ä¸­ï¼Œæ­¤æ—¶min=[5],max=[æ— ]ï¼Œavg=[5.00]

  - 2å…ˆè¿›å…¥å°é¡¶å †ï¼Œç„¶åå°†å°é¡¶å †ä¸­æœ€å°å€¼æ”¾å…¥å¤§é¡¶å †ä¸­ï¼Œæ­¤æ—¶min=[5],max=[2],avg=[(5+2)/2]=[3.50]

  - 3å…ˆè¿›å…¥å¤§é¡¶å †ï¼Œç„¶åå°†å¤§é¡¶å †ä¸­æœ€å¤§å€¼æ”¾å…¥å°é¡¶å †ä¸­ï¼Œæ­¤æ—¶min=[3,5],max=[2],avg=[3.00]

  - 4å…ˆè¿›å…¥å°é¡¶å †ï¼Œç„¶åå°†å°é¡¶å †ä¸­æœ€å°å€¼æ”¾å…¥å¤§é¡¶å †ä¸­ï¼Œæ­¤æ—¶min=[4,5],max=[3,2],avg=[(4+3)/2]=[3.50]

  - 1å…ˆè¿›å…¥å¤§é¡¶å †ï¼Œç„¶åå°†å¤§é¡¶å †ä¸­æœ€å¤§å€¼æ”¾å…¥å°é¡¶å †ä¸­ï¼Œæ­¤æ—¶min=[3,4,5],max=[2,1]ï¼Œavg=[3/00]

  - 6å…ˆè¿›å…¥å°é¡¶å †ï¼Œç„¶åå°†å°é¡¶å †ä¸­æœ€å°å€¼æ”¾å…¥å¤§é¡¶å †ä¸­ï¼Œæ­¤æ—¶min=[4,5,6],max=[3,2,1],avg=[(4+3)/2]=[3.50]

  - 7å…ˆè¿›å…¥å¤§é¡¶å †ï¼Œç„¶åå°†å¤§é¡¶å †ä¸­æœ€å¤§å€¼æ”¾å…¥å°é¡¶å †ä¸­ï¼Œæ­¤æ—¶min=[4,5,6,7],max=[3,2,1],avg=[4]=[4.00]

  - 0å…ˆè¿›å…¥å°é¡¶å †ï¼Œç„¶åå°†å°é¡¶å †ä¸­æœ€å¤§å€¼æ”¾å…¥å°é¡¶å †ä¸­ï¼Œæ­¤æ—¶min=[4,5,6,7],max=[3,2,1,0],avg=[(4+3)/2]=[3.50]

  - 8å…ˆè¿›å…¥å¤§é¡¶å †ï¼Œç„¶åå°†å¤§é¡¶å †ä¸­æœ€å°å€¼æ”¾å…¥å¤§é¡¶å †ä¸­ï¼Œæ­¤æ—¶min=[4,5,6,7,8],max=[3,2,1,0],avg=[4.00]

- ä»£ç 

  ```java
  import java.util.PriorityQueue;
  import java.util.Comparator;
  public class Solution {
      //å°é¡¶å †
      private PriorityQueue<Integer> minHeap = new PriorityQueue<Integer>();
      
      //å¤§é¡¶å †
      private PriorityQueue<Integer> maxHeap = new PriorityQueue<Integer>(15, new Comparator<Integer>() {
          @Override
          public int compare(Integer o1, Integer o2) {
              return o2 - o1;
          }
      });
      
      //è®°å½•å¶æ•°ä¸ªè¿˜æ˜¯å¥‡æ•°ä¸ª
      int count = 0;
      //æ¯æ¬¡æ’å…¥å°é¡¶å †çš„æ˜¯å½“å‰å¤§é¡¶å †ä¸­æœ€å¤§çš„æ•°
      //æ¯æ¬¡æ’å…¥å¤§é¡¶å †çš„æ˜¯å½“å‰å°é¡¶å †ä¸­æœ€å°çš„æ•°
      //è¿™æ ·ä¿è¯å°é¡¶å †ä¸­çš„æ•°æ°¸è¿œå¤§äºç­‰äºå¤§é¡¶å †ä¸­çš„æ•°
      //ä¸­ä½æ•°å°±å¯ä»¥æ–¹ä¾¿åœ°ä»ä¸¤è€…çš„æ ¹ç»“ç‚¹ä¸­è·å–äº†
      public void Insert(Integer num) {
          //ä¸ªæ•°ä¸ºå¶æ•°çš„è¯ï¼Œåˆ™å…ˆæ’å…¥åˆ°å¤§é¡¶å †ï¼Œç„¶åå°†å¤§é¡¶å †ä¸­æœ€å¤§çš„æ•°æ’å…¥å°é¡¶å †ä¸­
          if(count % 2 == 0){
              maxHeap.offer(num);
              int max = maxHeap.poll();
              minHeap.offer(max);
          }else{
              //ä¸ªæ•°ä¸ºå¥‡æ•°çš„è¯ï¼Œåˆ™å…ˆæ’å…¥åˆ°å°é¡¶å †ï¼Œç„¶åå°†å°é¡¶å †ä¸­æœ€å°çš„æ•°æ’å…¥å¤§é¡¶å †ä¸­
              minHeap.offer(num);
              int min = minHeap.poll();
              maxHeap.offer(min);
          }
          count++;
      }
      public Double GetMedian() {
          //å½“å‰ä¸ºå¶æ•°ä¸ªï¼Œåˆ™å–å°é¡¶å †å’Œå¤§é¡¶å †çš„å †é¡¶å…ƒç´ æ±‚å¹³å‡
          if(count % 2 == 0){
              return new Double(minHeap.peek() + maxHeap.peek())/2;
          }else{
              //å½“å‰ä¸ºå¥‡æ•°ä¸ªï¼Œåˆ™ç›´æ¥ä»å°é¡¶å †ä¸­å–å…ƒç´ å³å¯
              return new Double(minHeap.peek());
          }
      }
  }
  
  ```

### 3.11 è¡¨è¾¾å¼æ±‚å€¼

å¯¹äºã€Œä»»ä½•è¡¨è¾¾å¼ã€è€Œè¨€ï¼Œæˆ‘ä»¬éƒ½ä½¿ç”¨ä¸¤ä¸ªæ ˆ `nums` å’Œ `ops`ï¼š

- `nums` ï¼š å­˜æ”¾æ‰€æœ‰çš„æ•°å­—
- `ops` ï¼šå­˜æ”¾æ‰€æœ‰çš„æ•°å­—ä»¥å¤–çš„æ“ä½œ

ç„¶åä»å‰å¾€ååšï¼Œå¯¹éå†åˆ°çš„å­—ç¬¦åšåˆ†æƒ…å†µè®¨è®ºï¼š

- ç©ºæ ¼ : è·³è¿‡
- `(` : ç›´æ¥åŠ å…¥ `ops` ä¸­ï¼Œç­‰å¾…ä¸ä¹‹åŒ¹é…çš„ `)`
- `)` : ä½¿ç”¨ç°æœ‰çš„ `nums` å’Œ `ops` è¿›è¡Œè®¡ç®—ï¼Œç›´åˆ°é‡åˆ°å·¦è¾¹æœ€è¿‘çš„ä¸€ä¸ªå·¦æ‹¬å·ä¸ºæ­¢ï¼Œè®¡ç®—ç»“æœæ”¾åˆ° `nums`
- æ•°å­— : ä»å½“å‰ä½ç½®å¼€å§‹ç»§ç»­å¾€åå–ï¼Œå°†æ•´ä¸€ä¸ªè¿ç»­æ•°å­—æ•´ä½“å–å‡ºï¼ŒåŠ å…¥ `nums`
- `+ - *` : éœ€è¦å°†æ“ä½œæ”¾å…¥ `ops` ä¸­ã€‚**åœ¨æ”¾å…¥ä¹‹å‰å…ˆæŠŠæ ˆå†…å¯ä»¥ç®—çš„éƒ½ç®—æ‰ï¼ˆåªæœ‰ã€Œæ ˆå†…è¿ç®—ç¬¦ã€æ¯”ã€Œå½“å‰è¿ç®—ç¬¦ã€ä¼˜å…ˆçº§é«˜/åŒç­‰ï¼Œæ‰è¿›è¡Œè¿ç®—ï¼‰**ï¼Œä½¿ç”¨ç°æœ‰çš„ `nums` å’Œ `ops` è¿›è¡Œè®¡ç®—ï¼Œç›´åˆ°æ²¡æœ‰æ“ä½œæˆ–è€…é‡åˆ°å·¦æ‹¬å·ï¼Œè®¡ç®—ç»“æœæ”¾åˆ° `nums`

æˆ‘ä»¬å¯ä»¥é€šè¿‡ ğŸŒ° æ¥ç†è§£ **åªæœ‰ã€Œæ ˆå†…è¿ç®—ç¬¦ã€æ¯”ã€Œå½“å‰è¿ç®—ç¬¦ã€ä¼˜å…ˆçº§é«˜/åŒç­‰ï¼Œæ‰è¿›è¡Œè¿ç®—** æ˜¯ä»€ä¹ˆæ„æ€ï¼š

å› ä¸ºæˆ‘ä»¬æ˜¯ä»å‰å¾€ååšçš„ï¼Œå‡è®¾æˆ‘ä»¬å½“å‰å·²ç»æ‰«æåˆ° `2 + 1` äº†ï¼ˆæ­¤æ—¶æ ˆå†…çš„æ“ä½œä¸º `+` ï¼‰ã€‚

1. å¦‚æœåé¢å‡ºç°çš„ `+ 2` æˆ–è€… `- 1` çš„è¯ï¼Œæ»¡è¶³ã€Œæ ˆå†…è¿ç®—ç¬¦ã€æ¯”ã€Œå½“å‰è¿ç®—ç¬¦ã€ä¼˜å…ˆçº§é«˜/åŒç­‰ï¼Œå¯ä»¥å°† `2 + 1` ç®—æ‰ï¼ŒæŠŠç»“æœæ”¾åˆ° `nums` ä¸­ï¼›
2. å¦‚æœåé¢å‡ºç°çš„æ˜¯ `* 2` çš„è¯ï¼Œä¸æ»¡è¶³ã€Œæ ˆå†…è¿ç®—ç¬¦ã€æ¯”ã€Œå½“å‰è¿ç®—ç¬¦ã€ä¼˜å…ˆçº§é«˜/åŒç­‰ï¼Œè¿™æ—¶å€™ä¸èƒ½è®¡ç®— `2 + 1`ã€‚

ä¸€äº›ç»†èŠ‚ï¼š

- ç”±äºç¬¬ä¸€ä¸ªæ•°å¯èƒ½æ˜¯è´Ÿæ•°ï¼Œä¸ºäº†å‡å°‘è¾¹ç•Œåˆ¤æ–­ã€‚ä¸€ä¸ªå°æŠ€å·§æ˜¯å…ˆå¾€ `nums` æ·»åŠ ä¸€ä¸ª 0
- ä¸ºé˜²æ­¢ () å†…å‡ºç°çš„é¦–ä¸ªå­—ç¬¦ä¸ºè¿ç®—ç¬¦ï¼Œå°†æ‰€æœ‰çš„ç©ºæ ¼å»æ‰ï¼Œå¹¶å°† `(-` æ›¿æ¢ä¸º `(0-`ï¼Œ`(+` æ›¿æ¢ä¸º `(0+`ï¼ˆå½“ç„¶ä¹Ÿå¯ä»¥ä¸è¿›è¡Œè¿™æ ·çš„é¢„å¤„ç†ï¼Œå°†è¿™ä¸ªå¤„ç†é€»è¾‘æ”¾åˆ°å¾ªç¯é‡Œå»åšï¼‰
- ä»ç†è®ºä¸Šåˆ†æï¼Œ`nums` æœ€å¥½å­˜æ”¾çš„æ˜¯ `long`ï¼Œè€Œä¸æ˜¯ `int`ã€‚å› ä¸ºå¯èƒ½å­˜åœ¨ `å¤§æ•° + å¤§æ•° + å¤§æ•° + â€¦ - å¤§æ•° - å¤§æ•°` çš„è¡¨è¾¾å¼å¯¼è‡´ä¸­é—´ç»“æœæº¢å‡ºï¼Œæœ€ç»ˆç­”æ¡ˆä¸æº¢å‡ºçš„æƒ…å†µ

 **äº‹å®ä¸Šï¼Œæˆ‘æä¾›è¿™å¥—è§£å†³æ–¹æ¡ˆä¸ä»…ä»…èƒ½è§£å†³åªæœ‰ `+ - \* ( )` æˆ–è€… `+ - \* / ( )` çš„è¡¨è¾¾å¼é—®é¢˜ï¼Œè¿˜èƒ½è§£å†³ `+ - \* / ^ % ( )` çš„å®Œå…¨è¡¨è¾¾å¼é—®é¢˜ã€‚**ç”šè‡³æ”¯æŒ		è‡ªå®šä¹‰è¿ç®—ç¬¦ï¼Œåªè¦åœ¨è¿ç®—ä¼˜å…ˆçº§ä¸Šè¿›è¡Œç»´æŠ¤å³å¯ã€‚

```java
import java.util.*;
public class Solution {
    // ä½¿ç”¨ map ç»´æŠ¤ä¸€ä¸ªè¿ç®—ç¬¦ä¼˜å…ˆçº§
    // è¿™é‡Œçš„ä¼˜å…ˆçº§åˆ’åˆ†æŒ‰ç…§ã€Œæ•°å­¦ã€è¿›è¡Œåˆ’åˆ†å³å¯
    Map<Character, Integer> map = new HashMap<Character, Integer>(){{
        put('-', 1);
        put('+', 1);
        put('*', 2);
        put('/', 2);
        put('%', 2);
        put('^', 3);
    }};
    public int solve(String s) {
        // å°†æ‰€æœ‰çš„ç©ºæ ¼å»æ‰
        s = s.replaceAll(" ", "");
        char[] cs = s.toCharArray();
        int n = s.length();
        // å­˜æ”¾æ‰€æœ‰çš„æ•°å­—
        Deque<Integer> nums = new ArrayDeque<>();
        // ä¸ºäº†é˜²æ­¢ç¬¬ä¸€ä¸ªæ•°ä¸ºè´Ÿæ•°ï¼Œå…ˆå¾€ nums åŠ ä¸ª 0
        nums.addLast(0);
        // å­˜æ”¾æ‰€æœ‰ã€Œéæ•°å­—ä»¥å¤–ã€çš„æ“ä½œ
        Deque<Character> ops = new ArrayDeque<>();
        for (int i = 0; i < n; i++) {
            char c = cs[i];
            if (c == '(') {
                ops.addLast(c);
            } else if (c == ')') {
                // è®¡ç®—åˆ°æœ€è¿‘ä¸€ä¸ªå·¦æ‹¬å·ä¸ºæ­¢
                while (!ops.isEmpty()) {
                    if (ops.peekLast() != '(') {
                        calc(nums, ops);
                    } else {
                        ops.pollLast();
                        break;
                    }
                }
            } else {
                if (isNumber(c)) {
                    int u = 0;
                    int j = i;
                    // å°†ä» i ä½ç½®å¼€å§‹åé¢çš„è¿ç»­æ•°å­—æ•´ä½“å–å‡ºï¼ŒåŠ å…¥ nums
                    while (j < n && isNumber(cs[j])) u = u * 10 + (cs[j++] - '0');
                    nums.addLast(u);
                    i = j - 1;
                } else {
                    if (i > 0 && (cs[i - 1] == '(' || cs[i - 1] == '+' || cs[i - 1] == '-')) {
                        nums.addLast(0);
                    }
                    // æœ‰ä¸€ä¸ªæ–°æ“ä½œè¦å…¥æ ˆæ—¶ï¼Œå…ˆæŠŠæ ˆå†…å¯ä»¥ç®—çš„éƒ½ç®—äº† 
                    // åªæœ‰æ»¡è¶³ã€Œæ ˆå†…è¿ç®—ç¬¦ã€æ¯”ã€Œå½“å‰è¿ç®—ç¬¦ã€ä¼˜å…ˆçº§é«˜/åŒç­‰ï¼Œæ‰è¿›è¡Œè¿ç®—
                    while (!ops.isEmpty() && ops.peekLast() != '(') {
                        char prev = ops.peekLast();
                        if (map.get(prev) >= map.get(c)) {
                            calc(nums, ops);
                        } else {
                            break;
                        }
                    }
                    ops.addLast(c);
                }
            }
        }
        // å°†å‰©ä½™çš„è®¡ç®—å®Œ
        while (!ops.isEmpty() && ops.peekLast() != '(') calc(nums, ops);
        return nums.peekLast();
    }
    // è®¡ç®—é€»è¾‘ï¼šä» nums ä¸­å–å‡ºä¸¤ä¸ªæ“ä½œæ•°ï¼Œä» ops ä¸­å–å‡ºè¿ç®—ç¬¦ï¼Œç„¶åæ ¹æ®è¿ç®—ç¬¦è¿›è¡Œè®¡ç®—å³å¯
    void calc(Deque<Integer> nums, Deque<Character> ops) {
        if (nums.isEmpty() || nums.size() < 2) return;
        if (ops.isEmpty()) return;
        int b = nums.pollLast(), a = nums.pollLast();
        char op = ops.pollLast();
        int ans = 0;
        if (op == '+') ans = a + b;
        else if (op == '-') ans = a - b;
        else if (op == '*') ans = a * b;    
        else if (op == '/') ans = a / b;    
        else if (op == '^') ans = (int)Math.pow(a, b);
        else if (op == '%') ans = a % b;
        nums.addLast(ans);
    }
    boolean isNumber(char c) {
        return Character.isDigit(c);
    }
}
```

### 3.12 æœ‰æ•ˆçš„æ‹¬å·

- ç®—æ³•åŸç†

  æ ˆå…ˆå…¥åå‡ºç‰¹ç‚¹æ°å¥½ä¸æœ¬é¢˜æ‹¬å·æ’åºç‰¹ç‚¹ä¸€è‡´ï¼Œå³è‹¥é‡åˆ°å·¦æ‹¬å·å…¥æ ˆï¼Œé‡åˆ°å³æ‹¬å·æ—¶å°†å¯¹åº”æ ˆé¡¶å·¦æ‹¬å·å‡ºæ ˆï¼Œåˆ™éå†å®Œæ‰€æœ‰æ‹¬å·å stack ä»ç„¶ä¸ºç©ºï¼›
  å»ºç«‹å“ˆå¸Œè¡¨ map æ„å»ºå·¦å³æ‹¬å·å¯¹åº”å…³ç³»ï¼škeyå·¦æ‹¬å·ï¼Œvalueå³æ‹¬å·ï¼›è¿™æ ·æŸ¥è¯¢ 22 ä¸ªæ‹¬å·æ˜¯å¦å¯¹åº”åªéœ€ O(1) æ—¶é—´å¤æ‚åº¦ï¼›å»ºç«‹æ ˆ stackï¼Œéå†å­—ç¬¦ä¸² s å¹¶æŒ‰ç…§ç®—æ³•æµç¨‹ä¸€ä¸€åˆ¤æ–­ã€‚

- ç®—æ³•æµç¨‹

  å¦‚æœ c æ˜¯å·¦æ‹¬å·ï¼Œåˆ™å…¥æ ˆ pushï¼›
  å¦åˆ™é€šè¿‡å“ˆå¸Œè¡¨åˆ¤æ–­æ‹¬å·å¯¹åº”å…³ç³»ï¼Œè‹¥ stack æ ˆé¡¶å‡ºæ ˆæ‹¬å· `stack.pop()` ä¸å½“å‰éå†æ‹¬å· c ä¸å¯¹åº”ï¼Œåˆ™æå‰è¿”å› falseã€‚

- è§£å†³è¾¹ç•Œé—®é¢˜

  - æ ˆä¸ºç©ºï¼šæ­¤æ—¶`stack.pop()`å°±ä¼šæŠ¥é”™ï¼›ç»™stackèµ‹åˆå€¼ï¼Œå½“stackä¸ºç©ºä¸”cä¸ºå³æ‹¬å·æ—¶ï¼Œå¯ä»¥æ­£å¸¸è¿”å›`false`ï¼›
  - å­—ç¬¦ä¸²ä»¥å·¦æ‹¬å·ç»“å°¾ï¼šæ­¤æƒ…å†µä¸‹å¯ä»¥æ­£å¸¸éå†å®Œæ•´ä¸ª `s`ï¼Œä½† `stack` ä¸­é—ç•™æœªå‡ºæ ˆçš„å·¦æ‹¬å·ï¼›å› æ­¤ï¼Œæœ€åéœ€è¿”å› `len(stack) == 1`ï¼Œä»¥åˆ¤æ–­æ˜¯å¦æ˜¯æœ‰æ•ˆçš„æ‹¬å·ç»„åˆã€‚

![GIF 2022-6-13 20-00-10](Datastructureandalgorithm.assets/GIF 2022-6-13 20-00-10.gif)

- ä»£ç 

  ```java
  class Solution {
      private static final Map<Character,Character> map = new HashMap<Character,Character>(){{
          put('{','}'); put('[',']'); put('(',')'); put('?','?');
      }};
      public boolean isValid(String s) {
          if(s.length() > 0 && !map.containsKey(s.charAt(0))) return false;
          LinkedList<Character> stack = new LinkedList<Character>() {{ add('?'); }};
          for(Character c : s.toCharArray()){
              if(map.containsKey(c)) stack.addLast(c);//å¦‚æœæœ‰å·¦æ‹¬å·ï¼Œå°±åŠ å…¥æ ˆä¸­
              else if(map.get(stack.removeLast()) != c) return false;//å·¦å³æ‹¬å·æˆä¸€å¯¹
          }
          return stack.size() == 1;
      }
  }
  ```

  
